; Copy the ordering code from the box front to the DWR_OPEN for reporting
For Each DWR_OPEN opening

if this.DWR.spiceSelector == NULL or this.DWR.spiceSelector == 0 then

	if spiceUCSPVO == TRUE then
		delete spiceUCSPVO
		delete PVO
	end if
	
	if spiceUCSBTC == TRUE then
		delete spiceUCSBTC
		delete BTC
	end if 	

	exit
end if

boxh := DX
boxw := DY
 

if cab.class == ASM_CLASS_BASE then
	; use this math instead of PREF=1. setting PREF fails when PQ > 1 (pull quantity)
	PVO = -this.DWR.DY/2 + this.DWR.DTR.DX/2  
	spiceUCSPVO<bool> = TRUE
	spiceUCSPVO<style> = 2
	spiceUCSPVO<desc> = spiceUCSPVO
else
	if cab.class == ASM_CLASS_UPPER then
		PVO = +this.DWR.DY/2 - this.DWR.DBR.DX/2  
		spiceUCSPVO<bool> = TRUE
		spiceUCSPVO<style> = 2
		spiceUCSPVO<desc> = spiceUCSPVO
	end if
end if
			
;BTC = DY - 0.5625 - 9.75 ; opening height - bottom clearance - desired box height
;spiceUCSBTC<bool> = TRUE
;spiceUCSBTC<style> = 2
;spiceUCSBTC<desc> = spiceUCSBTC
